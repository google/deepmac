---
layout: default
title: The surprising impact of mask-head architecture <br/>on novel class segmentation
description: Vighnesh Birodkar, Zhichao Lu, Siyang Li, Vivek Rathod, Jonathan Huang</br>Google
---


We tackle the problem of partially supervised instance segmentation in which we
are given box annotations for all classes, but masks for only a subset of
classes. We show that the architecture of the mask head plays a surprisingly
important role in generalizing to masks of unseen classes. The figure below
shows improved mask predictions for unseen classes as we use better mask-head
architectures.

<video autoplay="" loop="" muted="" playsinline="" width="100%">
 <source src="https://github.com/google/deepmac/blob/main/assets/deepmac_video.mp4?raw=true" type="video/mp4">
 </source>
</video>

Just by using better mask-head architectures (no extra losses or modules) we
achieve state-of-the-art performance in the partially supervised instance
segmentation task. We call our model **DeepMAC**, which is short for Deep
mask-heads above CenterNet.

## Code

*   [**Deep-MAC code**](https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/deepmac.md) -
    Used for most experiments with the
    [CenterNet](https://arxiv.org/abs/1904.07850) architecture.
*   [**Deep-MARC code**](https://github.com/tensorflow/models/tree/master/official/projects/deepmac_maskrcnn) -
    Used for our Mask-RCNN based model.

## Demos
*   [**Colab**](https://github.com/tensorflow/models/tree/master/research/object_detection/colab_tutorials/deepmac_colab.ipynb)
    for interactively trying out a pre-trained model.
*   [**iWildCam Notebook**](https://www.kaggle.com/vighneshbgoogle/iwildcam-visualize-instance-masks)
    to visualize instance masks generated by DeepMAC on the iWildCam dataset.

## Main Results

In this table (X&#8594;Y) indicates that we train on masks from 'X' classes and
evaluate with masks from 'Y' classes. These experiments are done on the COCO
dataset. The VOC split contains 20 classes and the non-VOC split contains 60
classes. Bounding boxes are provided for all classes.

<table>
  <tr>
    <td> <b>Train &#8594; Eval </b></td>
    <td> <b>Model </b></td>
    <td> <b>Mask mAP </b></td>
    <td> <b>Config </b></td>
  </tr>
  <tr>
    <td rowspan="2">Deep-MAC (CetnerNet based)</td>
    <td> VOC&#8594;Non-VOC </td>
    <td> 35.5 </td>
    <td>
      <a href="https://github.com/tensorflow/models/blob/master/research/object_detection/configs/tf2/center_net_deepmac_1024x1024_voc_only_tpu-128.config"> 
        Link</a>
    </td>
  </tr>
  <tr>
    <td> Non-VOC&#8594;VOC </td>
    <td> 39.1 </td>
    <td>
      <a href="https://github.com/tensorflow/models/blob/master/research/object_detection/configs/tf2/center_net_deepmac_1024x1024_non_voc_only_tpu-128.config"> 
        Link</a>
    </td>
  </tr>
  <tr>
    <td rowspan="2">Deep-MARC (Mask R-CNN based)</td>
    <td> VOC&#8594;Non-VOC </td>
    <td> 38.7 </td>
    <td>
     <a href="https://github.com/tensorflow/models/blob/master/official/projects/deepmac_maskrcnn/configs/experiments/deep_mask_head_rcnn_voc_spinenet143_hg52.yaml">
       Link </a>
    </td>
  </tr>
  <tr>
    <td> Non-VOC&#8594;VOC </td>
    <td> 41.0 </td>
    <td>
     <a href="https://github.com/tensorflow/models/blob/master/official//projects/deepmac_maskrcnn/configs/experiments/deep_mask_head_rcnn_nonvoc_spinenet143_hg52.yaml">
       Link </a>
    </td>
  </tr>
</table>


## Checkpoints

Both these models take Image + boxes as input and produce per-box instance
masks as output.

*   [CenterNet Hourglass backbone](http://download.tensorflow.org/models/object_detection/tf2/20210329/deepmac_1024x1024_coco17.tar.gz)
*   [Mask-RCNN SpineNet backbone](https://storage.googleapis.com/tf_model_garden/vision/deepmac_maskrcnn/deepmarc_spinenet.zip)



## Citation
```
@misc{birodkar2021surprising,
      title={The surprising impact of mask-head architecture on novel class segmentation}, 
      author={Vighnesh Birodkar and Zhichao Lu and Siyang Li and Vivek Rathod and Jonathan Huang},
      year={2021},
      eprint={2104.00613},
      archivePrefix={arXiv},
      primaryClass={cs.CV}
}
```
